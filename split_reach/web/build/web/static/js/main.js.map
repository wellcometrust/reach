{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/clearSearch.js","webpack:///./src/js/resultsCommon.js","webpack:///./src/js/policyTable.js","webpack:///./src/js/citationsTable.js","webpack:///./src/js/app.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","reach","clearButton","document","getElementById","searchInput","addEventListener","SIZE","ORGS","toDisplayOrg","org","getPagination","currentPage","data","pages","maxPages","parseInt","Math","ceil","hits","total","max","min","getCounter","currentMin","getData","type","body","callback","xhr","XMLHttpRequest","url","term","fields","size","sort","order","page","open","responseType","send","onload","status","response","onabort","console","log","onerror","getCurrentState","currentSort","getAttribute","searchFields","join","refreshPolicy","currentState","table","loadingRow","getElementsByClassName","innerHTML","rows","item","_source","doc","authors","title","toTitleCase","length","slice","organisation","year","getPolicyTableContent","parentElement","classList","toggle","htmlElement","e","newPage","currentTarget","headers","newSort","setAttribute","querySelector","refreshCitations","accordions","forEach","match_authors","match_title","reference_id","match_publication","match_pub_year","policies","policy","policy_title","source_url","getCitationsTableContent","preventDefault","accordionBodyId","replace","firstChild","event","String","this","valueOf","toLowerCase","toUpperCase"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const clearSearch = (reach) => {\n    let clearButton = document.getElementById('search-clear');\n    let searchInput = document.getElementById('search-term');\n    if (clearButton) {\n        clearButton.addEventListener('click', () => {\n            searchInput.value = '';\n        });\n\n    }\n};\n\nexport default clearSearch;\n","const SIZE = 25;\n\nconst ORGS = {\n    'who_iris': 'WHO IRIS',\n    'nice': 'NICE',\n    'parliament': 'Parliament',\n    'unicef': 'UNICEF',\n    'msf': 'MSF',\n    'gov_uk': 'Gov.uk',\n};\n\nexport function toDisplayOrg(org) {\n    // Returns an organisation in a display appropriate format.\n    return ORGS[org];\n}\n\nexport function getPagination(currentPage, data) {\n    // Create the pagination list relative to the current state\n\n    let pages = ``;\n    if (currentPage > 0) {\n        pages += `<li class=\"page-item btn\" id=\"page-previous\">&lt Prev</li>`;\n    }\n    else {\n        pages += `<li class=\"btn disabled-page-item\" id=\"page-previous\">&lt Prev</li>`;\n    }\n\n    const maxPages = parseInt(Math.ceil(data.hits.total.value / SIZE));\n\n    if (currentPage > 2) {\n        pages += `<li class=\"page-item\" data-page=\"0\">1</li>`;\n\n        if (currentPage > 3) {\n            pages += `<li class=\"disabled-page-item\">...</li>`;\n        }\n    }\n\n    for (let i = Math.max(currentPage - 2, 0); i < Math.min(currentPage + 3, maxPages); ++i) {\n        if (i === currentPage) {\n            pages += `<li class=\"page-item active\" id=\"active-page\" data-page=\"${i}\">${i + 1}</li>`;\n        }\n        else {\n            pages += `<li class=\"page-item\" data-page=\"${i}\">${i + 1}</li>`;\n        }\n    }\n\n\n\n    if (currentPage < maxPages - 3) {\n\n        if (currentPage < maxPages - 4) {\n            pages += `<li class=\"disabled-page-item\">...</li>`;\n        }\n\n        pages += `<li class=\"page-item\" data-page=\"${maxPages - 1}\">${maxPages}</li>`;\n    }\n\n    if (currentPage < maxPages - 1) {\n        pages += `<li class=\"page-item btn\" id=\"page-next\">Next &gt</li>`;\n    }\n    else {\n        pages += `<li class=\"disabled-page-item btn\" id=\"page-next\">Next &gt</li>`;\n    }\n    return `<ul class=\"pages\">${pages}</ul>`;\n\n}\n\nexport function getCounter(currentPage, data) {\n    // Create the results counter (displyed `Docs XX to YY of ZZ`)\n\n    currentPage = parseInt(currentPage);\n    let currentMin = SIZE * currentPage + 1;\n    let currentMax = Math.min(currentMin + SIZE, data.hits.total.value);\n\n    return `<span>Showing ${currentMin} - ${currentMax} of ${data.hits.total.value} results</span>`;\n}\n\nexport function getData(type, body, callback) {\n    /* Query Reach public API to get the table data and callback\n      a refresh on that table.\n\n    Args:\n        type: the type of the data to get, passed as a string.\n              Should be either `policy-docs` or `citations`\n\n        body: a dictionary containing the current state of the\n              table\n\n        callback: the table refresh function to call when this\n                  function received data\n    */\n\n    let xhr = new XMLHttpRequest();\n\n    let url = `/api/search/${type}`\n              + `?terms=${body.term}`\n              + `&fields=${body.fields}`\n              + `&size=${body.size}`\n              + `&sort=${body.sort}`\n              + `&order=${body.order}`\n              + `&page=${body.page + 1}`;\n\n    xhr.open('GET', url);\n    xhr.responseType = 'json';\n    xhr.send();\n\n    xhr.onload = () => {\n        if (xhr.status == 200) {\n            callback(xhr.response, body);\n        }\n    };\n\n    xhr.onabort = () => {\n        console.log(xhr.response);\n    }\n\n    xhr.onerror = () => {\n        console.log(xhr.response);\n    };\n}\n\nexport function getCurrentState() {\n    /* Get the current values for the search term, order, sorting and page and\n    return them as a dictionary, used for both refreshing the table and\n    query new data through the API. */\n\n    const currentPage = document.getElementById('active-page');\n    const currentSort = document.getElementById('active-sort');\n    const searchTerm = document.getElementById('search-term');\n\n    let body = {\n        term: searchTerm.value,\n        size: SIZE,\n        page: (currentPage) ? parseInt(currentPage.getAttribute('data-page')) : 0,\n        sort: currentSort.getAttribute('data-sort'),\n        order: currentSort.getAttribute('data-order'),\n    };\n    return body;\n}\n","import {\n    getCurrentState,\n    getPagination,\n    getCounter,\n    getData,\n    toDisplayOrg,\n} from './resultsCommon.js';\n\nconst searchFields = [\n    'title',\n    'text',\n    'organisation',\n    'authors',\n].join(',');\n\nconst TITLE_LENGTH = 140;\n\nconst getPolicyTableContent = (data) => {\n    // Create the table rows to use in the policy-docs result table\n\n    let rows = ``;\n    for(let item of data.hits.hits) {\n        if (!item._source.doc.url) {\n            continue;\n        }\n        let authors = item._source.doc.authors?item._source.doc.authors:\"Unknown\";\n        let title = (item._source.doc.title)? item._source.doc.title.toTitleCase():\"Title unavailable\";\n        rows += `<tr>`;\n        rows += `<td><a\n            href=\"${item._source.doc.url}\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n        ><span class=\"icn icn-new-page\"></span></td>`;\n        rows += `<td title=\"${title}\"><a\n            href=\"${item._source.doc.url}\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n        >${(title.length > TITLE_LENGTH) ? (title.slice(0, TITLE_LENGTH) + \"...\") : title}</a></td>`;\n        rows += `<td>${toDisplayOrg(item._source.doc.organisation)}</td>`;\n        rows += `<td>${item._source.doc.year?item._source.doc.year:\"Unknown\"}</td>`;\n        rows += `</tr>`;\n\n    }\n    return rows;\n}\n\n\nconst refreshPolicy = (data, currentState) => {\n    // Get the parameters from the policy docs search page and use them\n    // to query Elasticsearch\n\n    const table = document.getElementById('policy-docs-results-tbody');\n    const loadingRow = document.getElementById('loading-row');\n    const pages = document.getElementsByClassName('page-item');\n\n    table.innerHTML = getPolicyTableContent(data);\n\n\n    table.parentElement.classList.toggle(\"load\");\n    loadingRow.classList.toggle(\"d-none\");\n\n    for (let htmlElement of document.getElementsByClassName('pagination-box'))\n    {\n            htmlElement.innerHTML = getPagination(\n            currentState.page,\n            data,\n        );\n    }\n\n    for (let htmlElement of document.getElementsByClassName('page-counter'))\n    {\n            htmlElement.innerHTML = getCounter(\n            currentState.page,\n            data,\n        );\n    }\n\n    for (let item of pages) {\n        item.addEventListener('click', (e) => {\n            let currentState = getCurrentState();\n            let currentPage = document.getElementById('active-page');\n            let pages = document.getElementsByClassName('page-item');\n\n            document.getElementById('policy-docs-result-table').classList.toggle(\"load\");\n            document.getElementById('loading-row').classList.toggle(\"d-none\");\n\n            currentState.fields = searchFields;\n            let newPage = e.currentTarget;\n\n            if (newPage.innerHTML === 'Prev') {\n                currentState.page -= 1;\n                newPage = pages[currentState.page];\n            }\n\n            else if (newPage.innerHTML === 'Next') {\n                currentState.page += 1;\n                newPage = pages[currentState.page];\n            }\n\n            else {\n                // newPage is an integer\n                currentState.page = parseInt(newPage.getAttribute('data-page'));\n            }\n            getData('policy-docs', currentState, refreshPolicy);\n        });\n    };\n}\n\nconst policyTable = () => {\n    const policy_table = document.getElementById('policy-docs-result-table');\n\n    if (policy_table) {\n        const headers = document.getElementsByClassName('sort');\n\n        for (let item of headers) {\n            item.addEventListener('click', (e) => {\n                let newSort = e.currentTarget.getAttribute('data-sort');\n                let currentSort = document.getElementById('active-sort');\n                let currentState = getCurrentState();\n\n                document.getElementById('policy-docs-result-table').classList.toggle(\"load\");\n                document.getElementById('loading-row').classList.toggle(\"d-none\");\n\n                currentState.fields = searchFields;\n                if (newSort == currentSort.getAttribute('data-sort')) {\n                    if (currentSort.getAttribute('data-order') === 'asc') {\n                        currentState.order = 'desc';\n                        currentSort.setAttribute('data-order', 'desc');\n\n                        currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sorted  icn-sorted-asc');\n                    }\n                    else {\n                        currentState.order = 'asc';\n                        currentSort.setAttribute('data-order', 'asc');\n\n                        currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sorted');\n                    }\n                }\n\n                else {\n                    e.currentTarget.setAttribute('data-order', 'asc');\n\n                    currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sort');\n                    e.currentTarget.querySelector('.icn').setAttribute('class', 'icn icn-sorted');\n                }\n\n                currentSort.setAttribute('id', null);\n                e.currentTarget.setAttribute('id', 'active-sort');\n                currentState.sort = newSort;\n                getData('policy-docs', currentState, refreshPolicy);\n            });\n        };\n\n        let body = getCurrentState();\n        body.fields = searchFields;\n        getData('policy-docs', body, refreshPolicy);\n    }\n}\n\nexport default policyTable;\n","import {\n    getCurrentState,\n    getPagination,\n    getCounter,\n    getData,\n    toDisplayOrg,\n} from './resultsCommon.js';\n\nconst TITLE_LENGTH = 140;\n\nconst searchFields = [\n    'match_title',\n    'policies.title',\n    'policies.organisation',\n    'match_source',\n    'match_publication',\n    'match_authors'\n].join(',');\n\nfunction getCitationsTableContent(data) {\n    let rows = ``;\n    data.hits.hits.forEach((item) => {\n        let authors = item._source.doc.match_authors ? item._source.doc.match_authors : \"Authors unavailable\";\n        let match_title = item._source.doc.match_title ? item._source.doc.match_title.toTitleCase() : \"Title unavailable\";\n        rows += `<tr class=\"accordion-row\" id=\"accordion-row-${item._source.doc.reference_id}\">`;\n        rows += `<td class=\"accordion-arrow\"><i class=\"icon icon-arrow-down mr-1\"></i></td>`\n        rows += `<td title=\"${match_title}\">${(match_title.length > TITLE_LENGTH) ? match_title.slice(0, TITLE_LENGTH) + \"...\" : match_title}</td>`;\n        rows += `<td>${item._source.doc.match_publication}</td>`;\n        rows += `<td class=\"authors-cell\" title=\"${authors}\">\n            ${(authors.length > TITLE_LENGTH) ? (authors.slice(0, TITLE_LENGTH) + \"...\") : authors}\n        </td>`;\n        rows += `<td>${item._source.doc.match_pub_year}</td>`;\n        rows += `<td>${item._source.doc.policies.length}</td>`;\n        rows += `</tr>`;\n\n        rows += `<tr class=\"accordion-body hidden\" id=\"accordion-body-${item._source.doc.reference_id}\">\n                    <td colspan=6 class=\"accordion-subtable-container\">\n                    <table class=\"table accordion-subtable\">\n                        <colgroup>\n                            <col class=\"colgroup-xl-col\">\n                            <col class=\"colgroup-medium-col\">\n                            <col>\n                        </colgroup>\n                        <tr>\n                            <th>Policy Document</th>\n                            <th>Policy Organisation</th>\n                            <th>Publication Year</th>\n                        </tr>\n        `;\n        for (let policy of item._source.doc.policies) {\n            let policy_title = policy.title ? policy.title.toTitleCase() : \"Title unavailable\";\n            rows += `<tr>`;\n            rows += `<td title=\"${policy_title}\"><a\n               href=\"${policy.source_url}\"\n               target=\"_blank\"\n               rel=\"noreferrer noopener\"\n            >${(policy_title.length > TITLE_LENGTH) ? (policy_title.slice(0, TITLE_LENGTH) + \"...\") : policy_title}</a></td>`;\n            rows += `<td>${toDisplayOrg(policy.organisation)}</td>`;\n            rows += `<td>${item._source.doc.match_pub_year}</td>`;\n        }\n        rows += `</table></td>`\n        rows += `</tr>`;\n    });\n    return rows;\n}\n\nfunction refreshCitations(data, currentState) {\n    // Get the parameters from the policy docs search page and use them\n    // to query Elasticsearch\n\n    const table = document.getElementById('citations-results-tbody');\n    const loadingRow = document.getElementById('loading-row');\n    const pages = document.getElementsByClassName('page-item');\n    const accordions = document.getElementsByClassName('accordion-row');\n\n    table.innerHTML = getCitationsTableContent(data);\n\n    table.parentElement.classList.toggle(\"load\");\n    loadingRow.classList.toggle(\"d-none\");\n\n    for (let htmlElement of document.getElementsByClassName('pagination-box'))\n    {\n            htmlElement.innerHTML = getPagination(\n            currentState.page,\n            data,\n        );\n    }\n\n    for (let htmlElement of document.getElementsByClassName('page-counter'))\n    {\n            htmlElement.innerHTML = getCounter(\n            currentState.page,\n            data,\n        );\n    }\n\n    for (let item of pages) {\n        item.addEventListener('click', (e) => {\n            e.preventDefault();\n            let currentState = getCurrentState();\n            let currentPage = document.getElementById('active-page');\n            let pages = document.getElementsByClassName('page-item')\n            currentState.fields = searchFields;\n\n            document.getElementById('citations-result-table').classList.toggle(\"load\");\n            document.getElementById('loading-row').classList.toggle(\"d-none\");\n\n             let newPage = e.currentTarget;\n\n            if (newPage.getAttribute('id') == 'page-previous') {\n                currentState.page -= 1;\n                newPage = pages[currentState.page];\n            }\n\n            else if (newPage.getAttribute('id') == 'page-next') {\n                currentState.page += 1;\n                newPage = pages[currentState.page];\n            }\n\n            else {\n                // newPage is an integer\n                currentState.page = parseInt(newPage.getAttribute('data-page'));\n            }\n            getData('citations', currentState, refreshCitations);\n        });\n    };\n\n    for (let item of accordions) {\n        item.addEventListener('click', (e) => {\n            const accordionBodyId = e.currentTarget.getAttribute('id').replace('row', 'body');\n\n            let accordionBody = document.getElementById(accordionBodyId);\n\n            accordionBody.classList.toggle('hidden');\n            e.currentTarget.classList.toggle('active-row');\n            e.currentTarget.firstChild.firstChild.classList.toggle('icon-arrow-down');\n            e.currentTarget.firstChild.firstChild.classList.toggle('icon-arrow-up');\n        });\n    }\n}\n\n\n\nconst citationsTable = () => {\n    const citation_table = document.getElementById('citations-result-table');\n\n    if (citation_table) {\n        const headers = document.getElementsByClassName('sort');\n\n        for (let item of headers) {\n            item.addEventListener('click', (e) => {\n                let newSort = e.currentTarget.getAttribute('data-sort');\n                let currentSort = document.getElementById('active-sort');\n                let currentState = getCurrentState();\n\n                document.getElementById('citations-result-table').classList.toggle(\"load\");\n                document.getElementById('loading-row').classList.toggle(\"d-none\");\n\n                currentState.fields = searchFields;\n                if (newSort === currentState.sort) {\n                    if (currentSort.getAttribute('data-order') === 'asc') {\n                        currentState.order = 'desc';\n                        currentSort.setAttribute('data-order', 'desc');\n\n                        currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sorted icn-sorted-asc');\n                    }\n                    else {\n                        currentState.order = 'asc';\n                        currentSort.setAttribute('data-order', 'asc');\n\n                        currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sorted');\n                    }\n                }\n\n                else {\n                    e.currentTarget.setAttribute('data-order', 'asc');\n\n                    currentSort.setAttribute('id', null);\n                    e.currentTarget.setAttribute('id', 'active-sort');\n\n                    currentSort.querySelector('.icn').setAttribute('class', 'icn icn-sort');\n                    e.currentTarget.querySelector('.icn').setAttribute('class', 'icn icn-sorted');\n\n                }\n                currentState.sort = newSort;\n                getData('citations', currentState, refreshCitations);\n            });\n        };\n\n        let body = getCurrentState();\n        body.fields = searchFields;\n        getData('citations', body, refreshCitations);\n    }\n}\n\nexport default citationsTable;\n","import clearSearch from './clearSearch.js';\nimport policyTable from './policyTable.js';\nimport citationsTable from './citationsTable.js';\n\ndocument.addEventListener('DOMContentLoaded', function(event) {\n    String.prototype.toTitleCase = function() {\n        let lower = this.valueOf().toLowerCase();\n        return lower.replace(/^\\w/, c => c.toUpperCase());;\n    };\n\n    clearSearch();\n    policyTable();\n    citationsTable();\n});\n"],"sourceRoot":""}